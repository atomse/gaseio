{% if not arrays | islist %}
{% set min_cell_size=21.0|int if min_cell_size is not defined or min_cell_size|int < 21|int else min_cell_size|int %}
{{comments if comments else 'Generated by GASEIO'}}
{{positions|length}}
{% for i in range(positions|length) %}
{{"%5d%-5s%5s%5d%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f"|format(residue_number[i] if residue_number is defined else 1, residue_name[i] if residue_name is defined else "DUM", customized_symbols[i] if customized_symbols is defined else symbols[i], i+1, positions[i][0]/10.0, positions[i][1]/10.0, positions[i][2]/10.0, velocity[i][0]/10.0 if velocity is defined else 0.0, velocity[i][1]/10.0 if velocity is defined else 0.0, velocity[i][2]/10.0 if velocity is defined else 0.0)}}
{% endfor %}
{% if cell is defined and cell[0][1] == 0 and cell[0][2] == 0 and cell[1][0] == 0 %}
{{cell[0][0]}} {{cell[1][1]}} {{cell[2][2]}}
{% else %}
{{[atoms_size[0]*2, min_cell_size] | max /10.0}} {{[atoms_size[1]*2, min_cell_size] | max /10.0}} {{[atoms_size[2]*2, min_cell_size] | max /10.0}}
{% endif %}
{% else %}
{% set min_cell_size=21.0|int if not 'min_cell_size' in arrays[0] or arrays[0]['min_cell_size']|int < 21|int else arrays[0]['min_cell_size']|int %}
{% for arr in arrays %}
{{arr['comments'] if 'comments' in arr else 'Generated by GASEIO'}}
{{arr['positions']|length}}
{% for i in range(arr['positions']|length) %}
{{"%5d%-5s%5s%5d%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f"|format(arr['residue_number'][i] if 'residue_number' in arr else 1, arr['residue_name'][i] if 'residue_name' in arr else "DUM", arr['customized_symbols'][i] if 'customized_symbols' in arr else arr['symbols'][i], i+1, arr['positions'][i][0]/10.0, arr['positions'][i][1]/10.0, arr['positions'][i][2]/10.0, arr['velocity'][i][0]/10.0 if 'velocity' in arr else 0.0, arr['velocity'][i][1]/10.0 if 'velocity' in arr else 0.0, arr['velocity'][i][2]/10.0 if 'velocity' in arr else 0.0)}}
{% endfor %}
{% if 'cell' in arr and arr['cell'][0][1] == 0 and arr['cell'][0][2] == 0 and arr['cell'][1][0] == 0 %}
{{arr['cell'][0][0]}} {{arr['cell'][1][1]}} {{arr['cell'][2][2]}}
{% else %}
{{[(arrays[0]['atoms_size'][0])*2, min_cell_size] | max /10.0}} {{[arrays[0]['atoms_size'][1]*2, min_cell_size] | max /10.0}} {{[arrays[0]['atoms_size'][2]*2, min_cell_size] | max /10.0}}
{% endif %}
{% endfor %}
{% endif %}
