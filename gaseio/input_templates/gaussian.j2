{% if calc_arrays is defined and 'maxcore' in calc_arrays %}
%nproc={{calc_arrays['maxcore']}}
{% else %}
%nproc=4
{% endif %}
{% if calc_arrays is defined and 'maxmem' in calc_arrays %}
%mem={{calc_arrays['maxmem']}}
{% else %}
%mem=2GB
{% endif %}
{% if chkfilename %}
%chk={{chkfilename | file_basename }}.chk
{% elif filename %}
%chk={{filename | file_basename }}.chk
{% else %}
%chk=preview_gaussian_{{randString}}.chk
{% endif %}
{% if oldchkfilename %}
%oldchk={{oldchkfilename | file_basename}}.chk
{% endif %}
{% if calc_arrays is defined and calc_arrays['command'] %}
{%if calc_arrays['command'].strip().startswith('p ') %}
#{{calc_arrays['command'].strip()}}
{% else %}
#p {{calc_arrays['command'].strip()}}
{% endif %}
{% else %}
#p force b3lyp/lanl2dz
{% endif %}

{% if comments is defined %}
{{comments}}
{% else %}
Generated by jinja2
{% endif %}

{% if charge is defined %}
{% if multiplicity is defined %}
{{charge|int}} {{multiplicity|int}}
{% else %}
{{charge|int}} 1
{% endif %}
{% else %}
0 1
{% endif %}{% for i in range((symbols|length)) %}
{% if constraint %}
{{symbols[i]}}    {{constraint[i]}}    {{"%.6f" | format(positions[i][0])}}    {{"%.6f" | format(positions[i][1])}}    {{"%.6f" | format(positions[i][2])}}
{% else %}
{{symbols[i]}}    {{"%.6f" | format(positions[i][0])}}    {{"%.6f" | format(positions[i][1])}}    {{"%.6f" | format(positions[i][2])}}
{% endif %}
{% endfor %}
{% if connectivity is defined and 'connectivity' in calc_arrays['commands']%}

{{connectivity}}
{% endif %}
{% if genecp is defined %}

{{genecp}}
{% endif %}
{% if NBO_analysis is defined %}

{{NBO_analysis}}
{% endif %}





