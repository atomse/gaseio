{% set min_cell_size=10.0|int if min_cell_size is not defined else min_cell_size|int %}
{% if comments %}
    {{comments}}
{% else %}
    Generated by gaseio
{% endif %}
1.00000
{% if cell is defined %}
    {% for i in range(3) %}
{% for j in range(3) %} {{"%12.6f" | format(cell[i][j])}} {% endfor %}

    {% endfor %}
{% else %}
 {{"%12.6f" | format([atoms_size[0]*2, min_cell_size] | max)}} 0. 0.
0.  {{"%12.6f" | format([atoms_size[1]*2, min_cell_size] | max)}} 0.
0. 0.  {{"%12.6f" | format([atoms_size[2]*2, min_cell_size] | max)}}
{% endif %}
{% if vasp_POSCAR_deep_contract is not defined or not vasp_POSCAR_deep_contract %}
{{ExtList(symbols).deep_contract_items("string")}}
{{ExtList(symbols).deep_contract_numbers("string")}}
{% else %}
{{ExtList(symbols).contract_items("string")}}
{{ExtList(symbols).contract_numbers("string")}}
{% endif %}
{% if constraints is defined %}
Selective Dynamics
{% endif %}
Cartesian
{% for i in range(positions|length) %}
    {% if vasp_POSCAR_deep_contract is not defined or not vasp_POSCAR_deep_contract %}
        {# {% if constraints is defined %} #}
            {% if cell is defined %}
 {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][0])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][1])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][2])}}  {{"False  False  False" if constraints[ExtList(symbols).deep_contract_index()[i]] and constraints is defined else " True   True   True"}}
            {% else %}
 {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][0] + atoms_size[0])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][1] + atoms_size[1])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][2] + atoms_size[2])}}  {{"False  False  False" if constraints[ExtList(symbols).deep_contract_index()[i]] and constraints is defined else " True   True   True"}}
            {% endif %}
{#         {% else %}
            {% if cell is defined %}
 {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][0])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][1])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][2])}}
            {% else %}
 {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][0] + atoms_size[0])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][1] + atoms_size[1])}}   {{"%12.6f" | format(positions[ExtList(symbols).deep_contract_index()[i]][2] + atoms_size[2])}}
            {% endif %}
        {% endif %} #}
    {% else %}
        {# {% if constraints is defined %} #}
            {% if cell is defined %}
 {{"%12.6f" | format(positions[i][0])}}   {{"%12.6f" | format(positions[i][1])}}   {{"%12.6f" | format(positions[i][2])}}  {{not constraints[i] if constraints is defined else ""}}  {{not constraints[i] if constraints is defined else ""}}  {{not constraints[i] if constraints is defined else ""}}
            {% else %}
 {{"%12.6f" | format(positions[i][0] + atoms_size[0])}}   {{"%12.6f" | format(positions[i][1] + atoms_size[1])}}   {{"%12.6f" | format(positions[i][2] + atoms_size[2])}}  {{not constraints[i] if constraints is defined else ""}}  {{not constraints[i] if constraints is defined else ""}}  {{not constraints[i] if constraints is defined else ""}}
            {% endif %}
{#         {% else %}
            {% if cell is defined %}
 {{"%12.6f" | format(positions[i][0])}}   {{"%12.6f" | format(positions[i][1])}}   {{"%12.6f" | format(positions[i][2])}}
            {% else %}
 {{"%12.6f" | format(positions[i][0] + atoms_size[0])}}   {{"%12.6f" | format(positions[i][1] + atoms_size[1])}}   {{"%12.6f" | format(positions[i][2] + atoms_size[2])}}
            {% endif %}
        {% endif %} #}
    {% endif %}
{% endfor %}

{% if velocity is defined and velocity|length > 0 %}
{% for i in range(velocity|length) %}
{{velocity[i][0]}}  {{velocity[i][1]}}  {{velocity[i][2]}}
{% endfor %}
{% endif %}






